"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}window.addEventListener("load",function(){var l=document.querySelector.bind(document),e=document.querySelectorAll('input[name="wpfcm-settings[keep-log]"]'),t=l('select[name="wpfcm-settings[scan-frequency]"]'),n=l('select[name="wpfcm-settings[scan-day]"]').parentNode,a=l('select[name="wpfcm-settings[scan-date]"]').parentNode,r=document.querySelectorAll(".wpfcm-files-container .add"),c=document.querySelectorAll(".wpfcm-files-container .remove"),o=l("#wpfcm-scan-start"),s=l("#wpfcm-scan-stop");function i(e){n.classList.add("hidden"),a.classList.add("hidden"),"weekly"===e?n.classList.remove("hidden"):"monthly"===e&&a.classList.remove("hidden")}function d(e){var t="",n=e.target.dataset.excludeType;"dirs"===n?t=/^\s*[a-z-._\d,\s/]+\s*$/i:"files"===n?t=/^\s*[a-z-._\d,\s]+\s*$/i:"exts"===n&&(t=/^\s*[a-z-._\d,\s]+\s*$/i);var a=l("#wpfcm-exclude-".concat(n,"-list")),r=e.target.parentNode.querySelector(".name"),c=r.value;if(c.match(t)){var o=document.createElement("span"),s=document.createElement("input"),i=document.createElement("label");s.type="checkbox",s.checked=!0,s.name="wpfcm-settings[scan-exclude-".concat(n,"][]"),s.id=c,s.value=c,i.setAttribute("for",c),i.innerHTML=c,o.appendChild(s),o.appendChild(i),a.appendChild(o),r.value=""}else"dirs"===n?alert(wpfcmData.dirInvalid):"files"===n?alert(wpfcmData.fileInvalid):"exts"===n&&alert(wpfcmData.extensionInvalid)}function u(e){for(var t=_toConsumableArray(e.target.parentNode.querySelectorAll(".exclude-list input[type=checkbox]")),n=[],a=0;a<t.length;a++)t[a].checked||n.push(t[a].value);if(n.length)for(var r=0;r<n.length;r++){var c=l('input[value="'+n[r]+'"]');c&&c.parentNode.remove()}}t.addEventListener("change",function(){i(this.value)}),i(t.value),_toConsumableArray(r).forEach(function(e){e.addEventListener("click",d)}),_toConsumableArray(c).forEach(function(e){e.addEventListener("click",u)}),_toConsumableArray(e).forEach(function(e){e.addEventListener("change",function(){var t;t=this.value,_toConsumableArray(document.querySelectorAll(".wpfcm-table fieldset")).forEach(function(e){e.disabled="no"===t})})}),o.addEventListener("click",function(t){t.target.value=wpfcmData.scanButtons.scanning,t.target.disabled=!0,s.disabled=!1;var e=new Request(wpfcmData.monitor.start,{method:"GET",headers:{"X-WP-Nonce":wpfcmData.restRequestNonce}});fetch(e).then(function(e){return e.json()}).then(function(e){e&&(t.target.value=wpfcmData.scanButtons.scanNow,t.target.disabled=!1,s.disabled=!0)}).catch(function(e){t.target.value=wpfcmData.scanButtons.scanFailed,t.target.disabled=!1,s.disabled=!0,console.log(e)})}),s.addEventListener("click",function(t){t.target.value=wpfcmData.scanButtons.stopping,t.target.disabled=!0;var e=new Request(wpfcmData.monitor.stop,{method:"GET",headers:{"X-WP-Nonce":wpfcmData.restRequestNonce}});fetch(e).then(function(e){return e.json()}).then(function(e){e&&(t.target.value=wpfcmData.scanButtons.scanStop,o.disabled=!1)}).catch(function(e){console.log(e)})})});